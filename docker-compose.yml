services:
  discord:
    build: ./
    # image: ghcr.io/taichikuji/ui-py
    restart: on-failure:5
    container_name: ui
    environment:
      - TOKEN=${TOKEN}
      - STEAM_TOKEN=${STEAM_TOKEN}
    volumes:
      - ui_db:/usr/src/app/data

  updater:
    build: ./updater
    container_name: ui-updater
    restart: unless-stopped
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - .:/workspace:z
    environment:
      - CRON_SCHEDULE=${CRON_SCHEDULE:-0 0 * * *}

volumes:
  ui_db: